npm install express-rate-limit
// ğŸ›¡ï¸ ProtecciÃ³n avanzada contra bots y abuso
import express from "express";
import fs from "fs";
import rateLimit from "express-rate-limit";

const app = express();

// --- Lista de rutas sospechosas (por seguridad) ---
const blockedPaths = [
  "/wp-admin",
  "/wordpress",
  "/wp-login",
  "/xmlrpc.php",
  "/.env"
];

// --- Lista opcional de IPs bloqueadas ---
const blockedIPs = [
  "192.168.0.1", // ejemplo, puedes agregar mÃ¡s si ves repetidas
];

// --- Middleware: bloqueo por ruta o IP sospechosa ---
app.use((req, res, next) => {
  const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;

  // Bloqueo por rutas sospechosas
  if (blockedPaths.some(path => req.url.startsWith(path))) {
    const log = `ğŸš« Ruta bloqueada: ${req.url} desde IP ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  // Bloqueo por IP especÃ­fica
  if (blockedIPs.includes(ip)) {
    const log = `ğŸš« IP bloqueada: ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  next(); // Si pasa los filtros, continÃºa
});

// --- Limitador de solicitudes ---
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutos
  max: 100, // mÃ¡ximo 100 requests por IP
  message: "Demasiadas solicitudes desde esta IP, intenta de nuevo mÃ¡s tarde.",
  handler: (req, res, next, options) => {
    const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;
    const log = `âš ï¸ LÃ­mite alcanzado: ${ip} - ${req.url}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    res.status(options.statusCode).send(options.message);
  }
});

// Aplica el limitador a todas las rutas
app.use(limiter);// ğŸ›¡ï¸ ProtecciÃ³n avanzada contra bots y abuso
import express from "express";
import fs from "fs";
import rateLimit from "express-rate-limit";

const app = express();

// --- Lista de rutas sospechosas (por seguridad) ---
const blockedPaths = [
  "/wp-admin",
  "/wordpress",
  "/wp-login",
  "/xmlrpc.php",
  "/.env"
];

// --- Lista opcional de IPs bloqueadas ---
const blockedIPs = [
  "192.168.0.1", // ejemplo, puedes agregar mÃ¡s si ves repetidas
];

// --- Middleware: bloqueo por ruta o IP sospechosa ---
app.use((req, res, next) => {
  const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;

  // Bloqueo por rutas sospechosas
  if (blockedPaths.some(path => req.url.startsWith(path))) {
    const log = `ğŸš« Ruta bloqueada: ${req.url} desde IP ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  // Bloqueo por IP especÃ­fica
  if (blockedIPs.includes(ip)) {
    const log = `ğŸš« IP bloqueada: ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  next(); // Si pasa los filtros, continÃºa
});

// --- Limitador de solicitudes ---
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutos
  max: 100, // mÃ¡ximo 100 requests por IP
  message: "Demasiadas solicitudes desde esta IP, intenta de nuevo mÃ¡s tarde.",
  handler: (req, res, next, options) => {
    const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;
    const log = `âš ï¸ LÃ­mite alcanzado: ${ip} - ${req.url}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    res.status(options.statusCode).send(options.message);
  }
});

// Aplica el limitador a todas las rutas
app.use(limiter);// ğŸ›¡ï¸ ProtecciÃ³n avanzada contra bots y abuso
import express from "express";
import fs from "fs";
import rateLimit from "express-rate-limit";

const app = express();

// --- Lista de rutas sospechosas (por seguridad) ---
const blockedPaths = [
  "/wp-admin",
  "/wordpress",
  "/wp-login",
  "/xmlrpc.php",
  "/.env"
];

// --- Lista opcional de IPs bloqueadas ---
const blockedIPs = [
  "192.168.0.1", // ejemplo, puedes agregar mÃ¡s si ves repetidas
];

// --- Middleware: bloqueo por ruta o IP sospechosa ---
app.use((req, res, next) => {
  const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;

  // Bloqueo por rutas sospechosas
  if (blockedPaths.some(path => req.url.startsWith(path))) {
    const log = `ğŸš« Ruta bloqueada: ${req.url} desde IP ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  // Bloqueo por IP especÃ­fica
  if (blockedIPs.includes(ip)) {
    const log = `ğŸš« IP bloqueada: ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  next(); // Si pasa los filtros, continÃºa
});

// --- Limitador de solicitudes ---
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutos
  max: 100, // mÃ¡ximo 100 requests por IP
  message: "Demasiadas solicitudes desde esta IP, intenta de nuevo mÃ¡s tarde.",
  handler: (req, res, next, options) => {
    const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;
    const log = `âš ï¸ LÃ­mite alcanzado: ${ip} - ${req.url}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    res.status(options.statusCode).send(options.message);
  }
});

// Aplica el limitador a todas las rutas
app.use(limiter);// ğŸ›¡ï¸ ProtecciÃ³n avanzada contra bots y abuso
import express from "express";
import fs from "fs";
import rateLimit from "express-rate-limit";

const app = express();

// --- Lista de rutas sospechosas (por seguridad) ---
const blockedPaths = [
  "/wp-admin",
  "/wordpress",
  "/wp-login",
  "/xmlrpc.php",
  "/.env"
];

// --- Lista opcional de IPs bloqueadas ---
const blockedIPs = [
  "192.168.0.1", // ejemplo, puedes agregar mÃ¡s si ves repetidas
];

// --- Middleware: bloqueo por ruta o IP sospechosa ---
app.use((req, res, next) => {
  const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;

  // Bloqueo por rutas sospechosas
  if (blockedPaths.some(path => req.url.startsWith(path))) {
    const log = `ğŸš« Ruta bloqueada: ${req.url} desde IP ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  // Bloqueo por IP especÃ­fica
  if (blockedIPs.includes(ip)) {
    const log = `ğŸš« IP bloqueada: ${ip}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    return res.status(403).send("Acceso denegado ğŸš«");
  }

  next(); // Si pasa los filtros, continÃºa
});

// --- Limitador de solicitudes ---
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutos
  max: 100, // mÃ¡ximo 100 requests por IP
  message: "Demasiadas solicitudes desde esta IP, intenta de nuevo mÃ¡s tarde.",
  handler: (req, res, next, options) => {
    const ip = req.headers["x-forwarded-for"] || req.socket.remoteAddress;
    const log = `âš ï¸ LÃ­mite alcanzado: ${ip} - ${req.url}\n`;
    fs.appendFileSync("blocked.log", log);
    console.log(log);
    res.status(options.statusCode).send(options.message);
  }
});

// Aplica el limitador a todas las rutas
app.use(limiter);Ahora, si algÃºn bot intenta:
	â€¢	Entrar a /wp-admin, /xmlrpc.php o rutas similares ğŸš«
	â€¢	Hacer mÃ¡s de 100 solicitudes en 15 minutos âš ï¸
â†’ El intento quedarÃ¡ registrado en un archivo llamado blocked.log en tu proyecto.ğŸš« Ruta bloqueada: /wp-admin/setup-config.php desde IP 45.33.21.88
âš ï¸ LÃ­mite alcanzado: 181.45.22.10 - /